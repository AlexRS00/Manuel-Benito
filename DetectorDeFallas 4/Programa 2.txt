        private void TimerLogica_Tick(object sender, EventArgs e)
        {
            string ErrorPort;
            try
            {
                //LEE EL VOLTAJE QUE SE ESTA SUMINISTRANDO EN LAS ENTRADAS ANALOGICAS
                //DEL MICROCONTROLADOR, DESDE EL A0 AL A5

                serialPort1.Write("5");
                P0 = serialPort1.ReadLine();
                Pass = 5 * Convert.ToDouble(P0) / 1023;

                serialPort1.Write("4");
                P1 = serialPort1.ReadLine();
                Fail = 5 * Convert.ToDouble(P1) / 1023;

                serialPort1.Write("3");
                P2 = serialPort1.ReadLine();
                Switch = 5 * Convert.ToDouble(P2) / 1023;

                serialPort1.Write("2");
                P3 = serialPort1.ReadLine();
                PassControl = 5 * Convert.ToDouble(P3) / 1023;

                serialPort1.Write("1");
                P4 = serialPort1.ReadLine();
                FailControl = 5 * Convert.ToDouble(P4) / 1023;

                serialPort1.Write("0");
                P5 = serialPort1.ReadLine();
                SwitchControl = 5 * Convert.ToDouble(P5) / 1023;

                label1.Text = Pass.ToString("0.00" + "V");
                label2.Text = Switch.ToString("0.00" + "V");
                label7.Text = Fail.ToString("0.00" + "V");
                label8.Text = PassControl.ToString("0.00" + "V");
                label9.Text = SwitchControl.ToString("0.00" + "V");
                label10.Text = FailControl.ToString("0.00" + "V");

                //DEPENDIENDO DEL RELEVADOR QUE ESTE CONTROLANDO CADA LAMPARA
                //SE SELECCIONARAN DIFERENTES CASOS
                int deteccion = x;

                if (SwitchControl < 1 & PassControl < 1 & FailControl < 1)
                {
                    x = 0;
                }
                if (SwitchControl > 1)
                {
                    x = 1;
                }
                if (PassControl > 1)
                {
                    x = 2;
                }
                if (FailControl > 1)
                {
                    x = 3;
                }
                if (SwitchControl > 1 & PassControl > 1)
                {
                    x = 4;
                }
                if (SwitchControl > 1 & FailControl > 1)
                {
                    x = 5;
                }
                if (PassControl > 1 & FailControl > 1)
                {
                    x = 6;
                }
                if (SwitchControl > 1 & PassControl > 1 & FailControl > 1)
                {
                    x = 7;
                }

                label6.Text = deteccion.ToString(); //MUESTRA EL CASE ACTUAL
                
                //SI EL RELEVADOR QUE CONTROLA A LA LAMPARA, ESTA ENERGIZADO, REALIZA LOS
                //SIGUIENTES CASOS

                switch (deteccion)
                {
                    case 0:
                        //SI NO HAY NINGUN CONTROL ACTIVO, NO HACE NADA
                        TimerFailCancel.Enabled = false;
                        TimerSwitchCancel.Enabled = false;
                        TimerPassCancel.Enabled = false;
                        TimerSwitchFail.Enabled = false;
                        TimerFailFail.Enabled = false;
                        TimerPassFail.Enabled = false;
                        break;

                    case 1: //LAMPARA SWITCH
                        if (Switch > 1)
                        {
                            //NO HAY FALLA
                            TimerSwitchCancel.Enabled = false;
                            TimerSwitchFail.Enabled = false;

                        }
                        if (Switch < 1)
                        {
                            //FALLA
                            TimerSwitchCancel.Enabled = true;
                            TimerSwitchFail.Enabled = true;
                            if (SwitchCount >= 5100)
                            {
                                TimerSwitchCancel.Enabled = false;
                                TimerSwitchFail.Enabled = false;
                            }
                        }
                        if (SwitchCount >= 5100)
                        {
                            if (Switch > 1)
                            {
                                TimerReporteSwitch.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        break;

                    case 2: //LAMPARA PASS
                        if (Pass > 1)
                        {
                            //NO HAY FALLA
                            TimerPassCancel.Enabled = false;
                            TimerPassFail.Enabled = false;
                        }
                        if (Pass < 1)
                        {
                            //FALLA
                            TimerPassCancel.Enabled = true;
                            TimerPassFail.Enabled = true;
                            if (PassCount >= 5100)
                            {
                                TimerPassCancel.Enabled = false;
                                TimerPassFail.Enabled = false;
                            }
                        }
                        if (PassCount >= 5100)
                        {
                            if (Pass > 1)
                            {
                                TimerReportePass.Enabled = true;
                                PassCount = 0;
                            }
                        }
                        break;

                    case 3: //LAMPARA FAIL
                        if (Fail > 1)
                        {
                            //NO HAY FALLA
                            TimerFailCancel.Enabled = false;
                            TimerFailFail.Enabled = false;
                        }
                        if (Fail < 1)
                        {
                            //FALLA
                            TimerFailCancel.Enabled = true;
                            TimerFailFail.Enabled = true;
                            if (FailCount >= 5100)
                            {
                                TimerFailCancel.Enabled = false;
                                TimerFailFail.Enabled = false;
                            }
                        }
                        if (FailCount >= 5100)
                        {
                            if (Fail > 1)
                            {
                                TimerReporteFail.Enabled = true;
                                FailCount = 0;
                            }
                        }
                        break;

                    //EL CASE 4 AL 7 SON CASOS EN LOS QUE EL TECNICO O ING ENCIENDE DE MANERA
                    //MANUAL LAS LAMPARAS DESDE EL PROGRAMA T7 DE LA TESTER

                    case 4: //LAMPARA SWITCH Y PASS
                        if (Switch > 1 & Pass > 1)
                        {
                            //NO HAY FALLA
                            TimerSwitchCancel.Enabled = false;
                            TimerPassCancel.Enabled = false;
                            TimerSwitchFail.Enabled = false;
                            TimerPassFail.Enabled = false;
                        }
                        if (Switch < 1 & Pass < 1)
                        {
                            //FALLA
                            TimerSwitchCancel.Enabled = true;
                            TimerSwitchFail.Enabled = true;
                            TimerPassCancel.Enabled = true;
                            TimerPassFail.Enabled = true;

                            if (SwitchCount >= 5100)
                            {
                                TimerSwitchCancel.Enabled = false;
                                TimerSwitchFail.Enabled = false;
                            }
                            if (PassCount >= 5100)
                            {
                                TimerPassFail.Enabled = false;
                                TimerPassCancel.Enabled = false;
                            }
                        }
                        if (SwitchCount >= 5100)
                        {
                            if (Switch > 1)
                            {
                                TimerReporteSwitch.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        if (PassCount >= 5100)
                        {
                            if (Pass > 1)
                            {
                                TimerReportePass.Enabled = true;
                                PassCount = 0;
                            }
                        }
                        break;


                    //CASE 5
                    case 5: //LAMPARA SWITCH Y FAIL
                        if (Switch > 1 & Fail > 1)
                        {
                            //NO HAY FALLA
                            TimerSwitchCancel.Enabled = false;
                            TimerFailCancel.Enabled = false;
                            TimerSwitchFail.Enabled = false;
                            TimerFailFail.Enabled = false;
                        }
                        if (Switch < 1 & Fail < 1)
                        {
                            //FALLA
                            TimerSwitchCancel.Enabled = true;
                            TimerSwitchFail.Enabled = true;
                            TimerFailCancel.Enabled = true;
                            TimerFailFail.Enabled = true;

                            if (SwitchCount >= 5100)
                            {
                                TimerSwitchCancel.Enabled = false;
                                TimerSwitchFail.Enabled = false;
                            }
                            if (FailCount >= 5100)
                            {
                                TimerFailFail.Enabled = false;
                                TimerFailCancel.Enabled = false;
                            }
                        }
                        if (SwitchCount >= 5100)
                        {
                            if (Switch > 1)
                            {
                                TimerReporteSwitch.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        if (FailCount >= 5100)
                        {
                            if (Fail > 1)
                            {
                                TimerReporteFail.Enabled = true;
                                FailCount = 0;
                            }
                        }
                        break;

                    //CASE 6
                    case 6: //LAMPARA PASS Y FAIL
                        if (Pass > 1 & Fail > 1)
                        {
                            //NO HAY FALLA
                            TimerPassCancel.Enabled = false;
                            TimerFailCancel.Enabled = false;
                            TimerPassFail.Enabled = false;
                            TimerFailFail.Enabled = false;
                        }
                        if (Pass < 1 & Fail < 1)
                        {
                            //FALLA
                            TimerPassCancel.Enabled = true;
                            TimerPassFail.Enabled = true;
                            TimerFailCancel.Enabled = true;
                            TimerFailFail.Enabled = true;

                            if (PassCount >= 5100)
                            {
                                TimerPassCancel.Enabled = false;
                                TimerPassFail.Enabled = false;
                            }
                            if (FailCount >= 5100)
                            {
                                TimerFailFail.Enabled = false;
                                TimerFailCancel.Enabled = false;
                            }
                        }
                        if (PassCount >= 5100)
                        {
                            if (Pass > 1)
                            {
                                TimerReportePass.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        if (FailCount >= 5100)
                        {
                            if (Fail > 1)
                            {
                                TimerReporteFail.Enabled = true;
                                FailCount = 0;
                            }
                        }
                        break;

                    //CASE CUANDO TODO ESTA ENCENDIDO
                    case 7: //LAMPARA PASS Y FAIL
                        if (Pass > 1 & Fail > 1 & Switch > 1)
                        {
                            //NO HAY FALLA
                            TimerPassCancel.Enabled = false;
                            TimerFailCancel.Enabled = false;
                            TimerPassFail.Enabled = false;
                            TimerFailFail.Enabled = false;
                            TimerSwitchCancel.Enabled = false;
                            TimerSwitchFail.Enabled = false;

                            if (SwitchCount >= 5100 || PassCount >= 5100 || FailCount >= 5100)
                            {
                                TimerReporteFail.Enabled = true;
                                SwitchCount = 0;
                                PassCount = 0;
                                FailCount = 0;
                            }

                        }
                        if (Pass < 1 & Fail < 1 & Switch < 1)
                        {
                            //FALLA
                            TimerPassCancel.Enabled = true;
                            TimerPassFail.Enabled = true;
                            TimerFailCancel.Enabled = true;
                            TimerFailFail.Enabled = true;
                            TimerSwitchCancel.Enabled = true;
                            TimerSwitchFail.Enabled = true;

                            if (PassCount >= 5100)
                            {
                                TimerPassCancel.Enabled = false;
                                TimerPassFail.Enabled = false;
                            }
                            if (FailCount >= 5100)
                            {
                                TimerFailFail.Enabled = false;
                                TimerFailCancel.Enabled = false;
                            }
                            if (SwitchCount >= 5100)
                            {
                                TimerSwitchFail.Enabled = false;
                                TimerSwitchCancel.Enabled = false;
                            }
                        }
                        if (PassCount >= 5100)
                        {
                            if (Pass > 1)
                            {
                                TimerReportePass.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        if (FailCount >= 5100)
                        {
                            if (Fail > 1)
                            {
                                TimerReporteFail.Enabled = true;
                                FailCount = 0;
                            }
                        }
                        if (SwitchCount >= 5100)
                        {
                            if (Switch > 1)
                            {
                                TimerReporteSwitch.Enabled = true;
                                SwitchCount = 0;
                            }
                        }
                        break;

                    default:
                        //no pasa nada
                        break;
                }
                    
            }
            catch (Exception Error)
            {
                ErrorPort = "Error: " + Error.Message;
                return;
            }

        }